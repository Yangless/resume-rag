nohup: ignoring input
Sliding Window Attention is enabled but not implemented for `sdpa`; unexpected results may be encountered.
/root/resume_summary/sftp.py:243: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `ChatGLMTrainer.__init__`. Use `processing_class` instead.
  trainer = ChatGLMTrainer(
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
加载模型和分词器...
trainable params: 9,232,384 || all params: 1,786,320,384 || trainable%: 0.5168
准备数据集...
[2025-07-07 22:41:40,927] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-07-07 22:41:42,290] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
开始训练...
  0%|          | 0/5475 [00:00<?, ?it/s]/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/data/data_collator.py:740: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:254.)
  batch["labels"] = torch.tensor(batch["labels"], dtype=torch.int64)
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|          | 1/5475 [00:09<14:49:57,  9.75s/it]  0%|          | 2/5475 [00:18<13:59:37,  9.20s/it]  0%|          | 3/5475 [00:27<13:57:26,  9.18s/it]  0%|          | 4/5475 [00:37<14:09:40,  9.32s/it]  0%|          | 5/5475 [00:46<14:04:56,  9.27s/it]  0%|          | 6/5475 [00:55<14:03:58,  9.26s/it]  0%|          | 7/5475 [01:04<14:04:27,  9.27s/it]  0%|          | 8/5475 [01:14<14:14:19,  9.38s/it]  0%|          | 9/5475 [01:23<14:10:46,  9.34s/it]  0%|          | 10/5475 [01:33<14:18:18,  9.42s/it]  0%|          | 11/5475 [01:43<14:24:07,  9.49s/it]  0%|          | 12/5475 [01:52<14:28:09,  9.54s/it]  0%|          | 13/5475 [02:02<14:31:16,  9.57s/it]  0%|          | 14/5475 [02:12<14:33:29,  9.60s/it]  0%|          | 15/5475 [02:21<14:34:40,  9.61s/it]  0%|          | 16/5475 [02:31<14:26:42,  9.53s/it]  0%|          | 17/5475 [02:40<14:20:43,  9.46s/it]  0%|          | 18/5475 [02:49<14:25:50,  9.52s/it]  0%|          | 19/5475 [02:59<14:20:21,  9.46s/it]  0%|          | 20/5475 [03:08<14:16:17,  9.42s/it]  0%|          | 21/5475 [03:18<14:22:22,  9.49s/it]  0%|          | 22/5475 [03:27<14:27:36,  9.55s/it]  0%|          | 23/5475 [03:37<14:21:00,  9.48s/it]  0%|          | 24/5475 [03:46<14:25:52,  9.53s/it]  0%|          | 25/5475 [03:56<14:20:13,  9.47s/it]  0%|          | 26/5475 [04:05<14:16:30,  9.43s/it]  0%|          | 27/5475 [04:15<14:22:12,  9.50s/it]  1%|          | 28/5475 [04:24<14:26:27,  9.54s/it]  1%|          | 29/5475 [04:34<14:29:07,  9.58s/it]  1%|          | 30/5475 [04:44<14:31:10,  9.60s/it]  1%|          | 31/5475 [04:53<14:32:15,  9.61s/it]  1%|          | 32/5475 [05:03<14:33:19,  9.63s/it]  1%|          | 33/5475 [05:13<14:33:41,  9.63s/it]  1%|          | 34/5475 [05:22<14:34:08,  9.64s/it]  1%|          | 35/5475 [05:32<14:34:18,  9.64s/it]  1%|          | 36/5475 [05:41<14:25:15,  9.55s/it]  1%|          | 37/5475 [05:51<14:18:48,  9.48s/it]  1%|          | 38/5475 [06:00<14:05:06,  9.33s/it]  1%|          | 39/5475 [06:09<14:04:11,  9.32s/it]  1%|          | 40/5475 [06:18<13:54:42,  9.21s/it]  1%|          | 41/5475 [06:27<14:06:33,  9.35s/it]  1%|          | 42/5475 [06:37<14:14:11,  9.43s/it]  1%|          | 43/5475 [06:47<14:19:43,  9.50s/it]  1%|          | 44/5475 [06:56<14:23:39,  9.54s/it]  1%|          | 45/5475 [07:06<14:26:17,  9.57s/it]  1%|          | 46/5475 [07:16<14:27:58,  9.59s/it]  1%|          | 47/5475 [07:25<14:29:11,  9.61s/it]  1%|          | 48/5475 [07:35<14:20:55,  9.52s/it]  1%|          | 49/5475 [07:44<14:24:16,  9.56s/it]  1%|          | 50/5475 [07:54<14:16:47,  9.48s/it]  1%|          | 51/5475 [08:03<14:12:19,  9.43s/it]  1%|          | 52/5475 [08:12<14:09:07,  9.39s/it]  1%|          | 53/5475 [08:22<14:15:49,  9.47s/it]  1%|          | 54/5475 [08:31<14:19:43,  9.52s/it]  1%|          | 55/5475 [08:41<14:22:47,  9.55s/it]  1%|          | 56/5475 [08:51<14:25:28,  9.58s/it]  1%|          | 57/5475 [09:00<14:27:00,  9.60s/it]  1%|          | 58/5475 [09:10<14:28:23,  9.62s/it]  1%|          | 59/5475 [09:20<14:29:09,  9.63s/it]  1%|          | 60/5475 [09:29<14:29:22,  9.63s/it]  1%|          | 61/5475 [09:39<14:20:34,  9.54s/it]  1%|          | 62/5475 [09:48<14:23:34,  9.57s/it]  1%|          | 63/5475 [09:58<14:16:56,  9.50s/it]  1%|          | 64/5475 [10:07<14:20:45,  9.54s/it]  1%|          | 65/5475 [10:17<14:23:20,  9.57s/it]  1%|          | 66/5475 [10:27<14:24:53,  9.59s/it]  1%|          | 67/5475 [10:36<14:17:27,  9.51s/it]  1%|          | 68/5475 [10:45<14:12:03,  9.46s/it]  1%|▏         | 69/5475 [10:55<14:08:37,  9.42s/it]  1%|▏         | 70/5475 [11:04<14:14:23,  9.48s/it]  1%|▏         | 71/5475 [11:14<14:18:41,  9.53s/it]  1%|▏         | 72/5475 [11:24<14:21:50,  9.57s/it]  1%|▏         | 73/5475 [11:33<14:23:38,  9.59s/it]  1%|▏         | 74/5475 [11:42<14:15:38,  9.51s/it]  1%|▏         | 75/5475 [11:52<14:19:17,  9.55s/it]  1%|▏         | 76/5475 [12:02<14:21:43,  9.58s/it]  1%|▏         | 77/5475 [12:11<14:23:32,  9.60s/it]  1%|▏         | 78/5475 [12:20<14:06:13,  9.41s/it]  1%|▏         | 79/5475 [12:30<14:12:38,  9.48s/it]  1%|▏         | 80/5475 [12:40<14:17:14,  9.53s/it]  1%|▏         | 81/5475 [12:49<14:10:53,  9.46s/it]  1%|▏         | 82/5475 [12:59<14:15:56,  9.52s/it]  2%|▏         | 83/5475 [13:08<14:19:18,  9.56s/it]  2%|▏         | 84/5475 [13:17<13:54:04,  9.28s/it]  2%|▏         | 85/5475 [13:27<14:03:12,  9.39s/it]  2%|▏         | 86/5475 [13:36<14:09:51,  9.46s/it]  2%|▏         | 87/5475 [13:45<14:04:54,  9.41s/it]  2%|▏         | 88/5475 [13:54<13:52:15,  9.27s/it]  2%|▏         | 89/5475 [14:04<14:02:19,  9.38s/it]  2%|▏         | 90/5475 [14:13<14:00:27,  9.36s/it]  2%|▏         | 91/5475 [14:23<13:58:29,  9.34s/it]  2%|▏         | 92/5475 [14:32<14:06:26,  9.43s/it]  2%|▏         | 93/5475 [14:42<14:11:25,  9.49s/it]  2%|▏         | 94/5475 [14:52<14:15:05,  9.53s/it]  2%|▏         | 95/5475 [15:01<14:08:51,  9.47s/it]  2%|▏         | 96/5475 [15:10<14:04:14,  9.42s/it]  2%|▏         | 97/5475 [15:20<14:09:26,  9.48s/it]  2%|▏         | 98/5475 [15:29<14:13:09,  9.52s/it]  2%|▏         | 99/5475 [15:39<14:16:35,  9.56s/it]  2%|▏         | 100/5475 [15:48<14:00:09,  9.38s/it]  2%|▏         | 101/5475 [15:58<14:06:56,  9.46s/it]  2%|▏         | 102/5475 [16:07<14:11:32,  9.51s/it]  2%|▏         | 103/5475 [16:17<14:14:56,  9.55s/it]  2%|▏         | 104/5475 [16:27<14:17:13,  9.58s/it]  2%|▏         | 105/5475 [16:36<14:19:00,  9.60s/it]  2%|▏         | 106/5475 [16:46<14:19:22,  9.60s/it]  2%|▏         | 107/5475 [16:55<14:02:59,  9.42s/it]  2%|▏         | 108/5475 [17:05<14:08:45,  9.49s/it]  2%|▏         | 109/5475 [17:14<14:12:48,  9.54s/it]  2%|▏         | 110/5475 [17:24<14:15:05,  9.56s/it]  2%|▏         | 111/5475 [17:33<14:16:30,  9.58s/it]  2%|▏         | 112/5475 [17:43<14:17:30,  9.59s/it]  2%|▏         | 113/5475 [17:52<14:01:16,  9.41s/it]  2%|▏         | 114/5475 [18:01<13:49:34,  9.28s/it]  2%|▏         | 115/5475 [18:10<13:49:35,  9.29s/it]  2%|▏         | 116/5475 [18:20<13:59:01,  9.39s/it]  2%|▏         | 117/5475 [18:30<14:05:15,  9.47s/it]  2%|▏         | 118/5475 [18:39<14:09:24,  9.51s/it]  2%|▏         | 119/5475 [18:49<14:12:23,  9.55s/it]  2%|▏         | 120/5475 [18:58<14:14:14,  9.57s/it]  2%|▏         | 121/5475 [19:07<13:58:48,  9.40s/it]  2%|▏         | 122/5475 [19:17<13:55:45,  9.37s/it]  2%|▏         | 123/5475 [19:26<13:54:20,  9.35s/it]  2%|▏         | 124/5475 [19:36<14:01:40,  9.44s/it]  2%|▏         | 125/5475 [19:45<13:57:46,  9.40s/it]  2%|▏         | 126/5475 [19:55<14:03:29,  9.46s/it]  2%|▏         | 127/5475 [20:04<14:07:50,  9.51s/it]  2%|▏         | 128/5475 [20:14<14:10:44,  9.55s/it]  2%|▏         | 129/5475 [20:24<14:12:59,  9.57s/it]  2%|▏         | 130/5475 [20:33<14:14:02,  9.59s/it]  2%|▏         | 131/5475 [20:43<14:14:51,  9.60s/it]  2%|▏         | 132/5475 [20:52<14:15:15,  9.60s/it]  2%|▏         | 133/5475 [21:02<14:15:28,  9.61s/it]  2%|▏         | 134/5475 [21:11<13:58:19,  9.42s/it]  2%|▏         | 135/5475 [21:20<13:54:46,  9.38s/it]  2%|▏         | 136/5475 [21:30<14:00:47,  9.45s/it]  3%|▎         | 137/5475 [21:39<14:04:43,  9.49s/it]  3%|▎         | 138/5475 [21:49<14:07:58,  9.53s/it]  3%|▎         | 139/5475 [21:58<14:01:04,  9.46s/it]  3%|▎         | 140/5475 [22:08<13:55:52,  9.40s/it]  3%|▎         | 141/5475 [22:17<14:01:24,  9.46s/it]  3%|▎         | 142/5475 [22:27<14:05:52,  9.52s/it]  3%|▎         | 143/5475 [22:36<14:08:01,  9.54s/it]  3%|▎         | 144/5475 [22:46<14:09:47,  9.56s/it]  3%|▎         | 145/5475 [22:56<14:10:59,  9.58s/it]  3%|▎         | 146/5475 [23:05<13:54:20,  9.39s/it]  3%|▎         | 147/5475 [23:14<14:00:11,  9.46s/it]  3%|▎         | 148/5475 [23:24<14:04:31,  9.51s/it]  3%|▎         | 149/5475 [23:34<14:07:01,  9.54s/it]  3%|▎         | 150/5475 [23:43<14:09:01,  9.57s/it]  3%|▎         | 151/5475 [23:52<14:01:01,  9.48s/it]  3%|▎         | 152/5475 [24:02<14:04:25,  9.52s/it]  3%|▎         | 153/5475 [24:12<14:07:08,  9.55s/it]  3%|▎         | 154/5475 [24:21<14:08:33,  9.57s/it]  3%|▎         | 155/5475 [24:31<14:09:51,  9.58s/it]  3%|▎         | 156/5475 [24:41<14:10:24,  9.59s/it]  3%|▎         | 157/5475 [24:50<14:02:40,  9.51s/it]  3%|▎         | 158/5475 [24:59<14:05:29,  9.54s/it]  3%|▎         | 159/5475 [25:09<14:07:03,  9.56s/it]  3%|▎         | 160/5475 [25:19<14:08:23,  9.58s/it]  3%|▎         | 161/5475 [25:28<14:09:26,  9.59s/it]  3%|▎         | 162/5475 [25:38<14:10:00,  9.60s/it]  3%|▎         | 163/5475 [25:48<14:10:18,  9.60s/it]  3%|▎         | 164/5475 [25:57<14:10:32,  9.61s/it]  3%|▎         | 165/5475 [26:06<14:01:08,  9.50s/it]  3%|▎         | 166/5475 [26:16<14:03:51,  9.54s/it]  3%|▎         | 167/5475 [26:26<14:05:17,  9.55s/it]  3%|▎         | 168/5475 [26:34<13:40:28,  9.28s/it]  3%|▎         | 169/5475 [26:44<13:40:14,  9.28s/it]  3%|▎         | 170/5475 [26:53<13:48:58,  9.38s/it]  3%|▎         | 171/5475 [27:03<13:54:44,  9.44s/it]  3%|▎         | 172/5475 [27:12<13:58:36,  9.49s/it]  3%|▎         | 173/5475 [27:22<14:01:23,  9.52s/it]  3%|▎         | 174/5475 [27:32<14:03:09,  9.54s/it]  3%|▎         | 175/5475 [27:41<14:04:23,  9.56s/it]  3%|▎         | 176/5475 [27:51<14:05:32,  9.57s/it]  3%|▎         | 177/5475 [28:00<13:57:41,  9.49s/it]  3%|▎         | 178/5475 [28:10<14:00:31,  9.52s/it]  3%|▎         | 179/5475 [28:19<14:02:55,  9.55s/it]  3%|▎         | 180/5475 [28:29<14:03:55,  9.56s/it]  3%|▎         | 181/5475 [28:38<14:05:23,  9.58s/it]  3%|▎         | 182/5475 [28:48<14:06:08,  9.59s/it]  3%|▎         | 183/5475 [28:58<14:06:38,  9.60s/it]  3%|▎         | 184/5475 [29:07<14:06:27,  9.60s/it]  3%|▎         | 185/5475 [29:17<14:06:10,  9.60s/it]  3%|▎         | 186/5475 [29:26<14:06:15,  9.60s/it]  3%|▎         | 187/5475 [29:36<14:06:09,  9.60s/it]  3%|▎         | 188/5475 [29:45<13:57:29,  9.50s/it]  3%|▎         | 189/5475 [29:55<14:00:20,  9.54s/it]  3%|▎         | 190/5475 [30:04<13:53:26,  9.46s/it]  3%|▎         | 191/5475 [30:14<13:48:46,  9.41s/it]  4%|▎         | 192/5475 [30:23<13:53:31,  9.47s/it]  4%|▎         | 193/5475 [30:33<13:56:45,  9.50s/it]  4%|▎         | 194/5475 [30:42<13:58:53,  9.53s/it]  4%|▎         | 195/5475 [30:52<13:52:08,  9.46s/it]  4%|▎         | 196/5475 [31:01<13:47:38,  9.41s/it]  4%|▎         | 197/5475 [31:10<13:44:09,  9.37s/it]  4%|▎         | 198/5475 [31:19<13:41:49,  9.34s/it]  4%|▎         | 199/5475 [31:29<13:49:18,  9.43s/it]  4%|▎         | 200/5475 [31:38<13:44:44,  9.38s/it]  4%|▎         | 201/5475 [31:48<13:50:20,  9.45s/it]  4%|▎         | 202/5475 [31:58<13:53:44,  9.49s/it]  4%|▎         | 203/5475 [32:07<13:47:40,  9.42s/it]  4%|▎         | 204/5475 [32:16<13:43:07,  9.37s/it]  4%|▎         | 205/5475 [32:26<13:48:51,  9.44s/it]  4%|▍         | 206/5475 [32:35<13:52:48,  9.48s/it]  4%|▍         | 207/5475 [32:45<13:55:48,  9.52s/it]  4%|▍         | 208/5475 [32:54<13:57:37,  9.54s/it]  4%|▍         | 209/5475 [33:04<13:59:07,  9.56s/it]  4%|▍         | 210/5475 [33:14<13:59:37,  9.57s/it]  4%|▍         | 211/5475 [33:23<14:00:03,  9.58s/it]  4%|▍         | 212/5475 [33:33<14:00:33,  9.58s/it]  4%|▍         | 213/5475 [33:42<13:51:55,  9.49s/it]  4%|▍         | 214/5475 [33:52<13:54:40,  9.52s/it]  4%|▍         | 215/5475 [34:01<13:56:30,  9.54s/it]  4%|▍         | 216/5475 [34:11<13:48:44,  9.46s/it]  4%|▍         | 217/5475 [34:20<13:43:37,  9.40s/it]  4%|▍         | 218/5475 [34:29<13:48:27,  9.46s/it]  4%|▍         | 219/5475 [34:39<13:52:12,  9.50s/it]  4%|▍         | 220/5475 [34:49<13:54:58,  9.53s/it]  4%|▍         | 221/5475 [34:58<13:56:09,  9.55s/it]  4%|▍         | 222/5475 [35:08<13:57:40,  9.57s/it]  4%|▍         | 223/5475 [35:17<13:41:33,  9.39s/it]  4%|▍         | 224/5475 [35:26<13:46:42,  9.45s/it]  4%|▍         | 225/5475 [35:36<13:50:50,  9.50s/it]  4%|▍         | 226/5475 [35:46<13:53:34,  9.53s/it]  4%|▍         | 227/5475 [35:55<13:55:20,  9.55s/it]  4%|▍         | 228/5475 [36:05<13:56:56,  9.57s/it]  4%|▍         | 229/5475 [36:14<13:57:12,  9.58s/it]  4%|▍         | 230/5475 [36:24<13:49:01,  9.48s/it]  4%|▍         | 231/5475 [36:33<13:43:17,  9.42s/it]  4%|▍         | 232/5475 [36:43<13:47:51,  9.47s/it]  4%|▍         | 233/5475 [36:52<13:42:33,  9.42s/it]  4%|▍         | 234/5475 [37:01<13:47:29,  9.47s/it]  4%|▍         | 235/5475 [37:11<13:41:54,  9.41s/it]  4%|▍         | 236/5475 [37:20<13:46:22,  9.46s/it]  4%|▍         | 237/5475 [37:30<13:49:57,  9.51s/it]  4%|▍         | 238/5475 [37:39<13:51:55,  9.53s/it]  4%|▍         | 239/5475 [37:49<13:54:18,  9.56s/it]  4%|▍         | 240/5475 [37:59<13:54:42,  9.57s/it]  4%|▍         | 241/5475 [38:08<13:54:56,  9.57s/it]  4%|▍         | 242/5475 [38:18<13:54:58,  9.57s/it]  4%|▍         | 243/5475 [38:27<13:46:42,  9.48s/it]  4%|▍         | 244/5475 [38:37<13:49:27,  9.51s/it]  4%|▍         | 245/5475 [38:46<13:52:12,  9.55s/it]  4%|▍         | 246/5475 [38:56<13:44:56,  9.47s/it]  5%|▍         | 247/5475 [39:05<13:47:49,  9.50s/it]  5%|▍         | 248/5475 [39:14<13:41:44,  9.43s/it]  5%|▍         | 249/5475 [39:24<13:45:43,  9.48s/it]  5%|▍         | 250/5475 [39:34<13:48:42,  9.52s/it]  5%|▍         | 251/5475 [39:43<13:50:13,  9.54s/it]  5%|▍         | 252/5475 [39:52<13:43:42,  9.46s/it]  5%|▍         | 253/5475 [40:02<13:46:51,  9.50s/it]  5%|▍         | 254/5475 [40:12<13:49:03,  9.53s/it]  5%|▍         | 255/5475 [40:21<13:51:03,  9.55s/it]  5%|▍         | 256/5475 [40:31<13:51:48,  9.56s/it]  5%|▍         | 257/5475 [40:40<13:52:41,  9.57s/it]  5%|▍         | 258/5475 [40:50<13:52:38,  9.58s/it]  5%|▍         | 259/5475 [41:00<13:53:13,  9.58s/it]  5%|▍         | 260/5475 [41:09<13:53:35,  9.59s/it]  5%|▍         | 261/5475 [41:19<13:45:02,  9.49s/it]  5%|▍         | 262/5475 [41:28<13:39:00,  9.43s/it]  5%|▍         | 263/5475 [41:37<13:42:57,  9.47s/it]  5%|▍         | 264/5475 [41:47<13:37:21,  9.41s/it]  5%|▍         | 265/5475 [41:56<13:41:57,  9.47s/it]  5%|▍         | 266/5475 [42:06<13:36:46,  9.41s/it]  5%|▍         | 267/5475 [42:15<13:32:43,  9.36s/it]  5%|▍         | 268/5475 [42:24<13:30:20,  9.34s/it]  5%|▍         | 269/5475 [42:33<13:28:19,  9.32s/it]  5%|▍         | 270/5475 [42:43<13:34:58,  9.39s/it]  5%|▍         | 271/5475 [42:52<13:39:58,  9.45s/it]  5%|▍         | 272/5475 [43:02<13:43:22,  9.50s/it]  5%|▍         | 273/5475 [43:11<13:36:48,  9.42s/it]  5%|▌         | 274/5475 [43:21<13:41:21,  9.48s/it]  5%|▌         | 275/5475 [43:30<13:35:44,  9.41s/it]  5%|▌         | 276/5475 [43:39<13:31:59,  9.37s/it]  5%|▌         | 277/5475 [43:49<13:29:10,  9.34s/it]  5%|▌         | 278/5475 [43:58<13:36:39,  9.43s/it]  5%|▌         | 279/5475 [44:08<13:31:38,  9.37s/it]  5%|▌         | 280/5475 [44:17<13:37:02,  9.44s/it]  5%|▌         | 281/5475 [44:27<13:41:27,  9.49s/it]  5%|▌         | 282/5475 [44:36<13:43:34,  9.52s/it]  5%|▌         | 283/5475 [44:46<13:36:36,  9.44s/it]  5%|▌         | 284/5475 [44:55<13:40:39,  9.49s/it]  5%|▌         | 285/5475 [45:05<13:43:27,  9.52s/it]  5%|▌         | 286/5475 [45:14<13:36:30,  9.44s/it]  5%|▌         | 287/5475 [45:24<13:39:51,  9.48s/it]  5%|▌         | 288/5475 [45:33<13:42:24,  9.51s/it]  5%|▌         | 289/5475 [45:43<13:44:23,  9.54s/it]  5%|▌         | 290/5475 [45:52<13:46:02,  9.56s/it]  5%|▌         | 291/5475 [46:02<13:38:08,  9.47s/it]  5%|▌         | 292/5475 [46:11<13:41:01,  9.50s/it]  5%|▌         | 293/5475 [46:21<13:43:16,  9.53s/it]  5%|▌         | 294/5475 [46:30<13:44:27,  9.55s/it]  5%|▌         | 295/5475 [46:40<13:45:32,  9.56s/it]  5%|▌         | 296/5475 [46:50<13:45:59,  9.57s/it]  5%|▌         | 297/5475 [46:59<13:46:11,  9.57s/it]  5%|▌         | 298/5475 [47:09<13:38:10,  9.48s/it]  5%|▌         | 299/5475 [47:18<13:40:43,  9.51s/it]  5%|▌         | 300/5475 [47:27<13:34:30,  9.44s/it]  5%|▌         | 301/5475 [47:37<13:38:27,  9.49s/it]  6%|▌         | 302/5475 [47:46<13:24:22,  9.33s/it]  6%|▌         | 303/5475 [47:55<13:22:36,  9.31s/it]  6%|▌         | 304/5475 [48:04<13:04:34,  9.10s/it]  6%|▌         | 305/5475 [48:13<13:16:57,  9.25s/it]  6%|▌         | 306/5475 [48:23<13:25:47,  9.35s/it]  6%|▌         | 307/5475 [48:33<13:32:35,  9.43s/it]  6%|▌         | 308/5475 [48:42<13:36:31,  9.48s/it]  6%|▌         | 309/5475 [48:52<13:39:10,  9.51s/it]  6%|▌         | 310/5475 [49:01<13:41:10,  9.54s/it]  6%|▌         | 311/5475 [49:11<13:42:08,  9.55s/it]  6%|▌         | 312/5475 [49:21<13:42:29,  9.56s/it]  6%|▌         | 313/5475 [49:30<13:34:37,  9.47s/it]  6%|▌         | 314/5475 [49:39<13:37:30,  9.50s/it]  6%|▌         | 315/5475 [49:49<13:31:31,  9.44s/it]  6%|▌         | 316/5475 [49:58<13:26:26,  9.38s/it]  6%|▌         | 317/5475 [50:07<13:23:50,  9.35s/it]  6%|▌         | 318/5475 [50:17<13:30:20,  9.43s/it]  6%|▌         | 319/5475 [50:26<13:34:26,  9.48s/it]  6%|▌         | 320/5475 [50:36<13:37:36,  9.52s/it]  6%|▌         | 321/5475 [50:46<13:39:37,  9.54s/it]  6%|▌         | 322/5475 [50:55<13:40:58,  9.56s/it]  6%|▌         | 323/5475 [51:05<13:33:57,  9.48s/it]  6%|▌         | 324/5475 [51:14<13:28:33,  9.42s/it]  6%|▌         | 325/5475 [51:23<13:32:26,  9.47s/it]  6%|▌         | 326/5475 [51:33<13:35:56,  9.51s/it]  6%|▌         | 327/5475 [51:43<13:38:35,  9.54s/it]  6%|▌         | 328/5475 [51:52<13:39:51,  9.56s/it]  6%|▌         | 329/5475 [52:01<13:32:05,  9.47s/it]  6%|▌         | 330/5475 [52:11<13:34:58,  9.50s/it]  6%|▌         | 331/5475 [52:21<13:37:11,  9.53s/it]  6%|▌         | 332/5475 [52:30<13:38:47,  9.55s/it]  6%|▌         | 333/5475 [52:40<13:39:57,  9.57s/it]  6%|▌         | 334/5475 [52:49<13:31:41,  9.47s/it]  6%|▌         | 335/5475 [52:59<13:34:31,  9.51s/it]  6%|▌         | 336/5475 [53:08<13:36:46,  9.54s/it]  6%|▌         | 337/5475 [53:18<13:38:35,  9.56s/it]  6%|▌         | 338/5475 [53:28<13:39:32,  9.57s/it]  6%|▌         | 339/5475 [53:37<13:40:12,  9.58s/it]  6%|▌         | 340/5475 [53:46<13:32:07,  9.49s/it]  6%|▌         | 341/5475 [53:56<13:34:35,  9.52s/it]  6%|▌         | 342/5475 [54:06<13:36:32,  9.54s/it]  6%|▋         | 343/5475 [54:15<13:37:51,  9.56s/it]  6%|▋         | 344/5475 [54:24<13:30:34,  9.48s/it]  6%|▋         | 345/5475 [54:33<13:16:36,  9.32s/it]  6%|▋         | 346/5475 [54:43<13:23:36,  9.40s/it]  6%|▋         | 347/5475 [54:53<13:28:14,  9.46s/it]  6%|▋         | 348/5475 [55:02<13:31:17,  9.49s/it]  6%|▋         | 349/5475 [55:12<13:34:13,  9.53s/it]  6%|▋         | 350/5475 [55:21<13:27:44,  9.46s/it]  6%|▋         | 351/5475 [55:30<13:22:14,  9.39s/it]  6%|▋         | 352/5475 [55:40<13:27:19,  9.46s/it]  6%|▋         | 353/5475 [55:49<13:22:46,  9.40s/it]  6%|▋         | 354/5475 [55:58<13:19:14,  9.36s/it]  6%|▋         | 355/5475 [56:08<13:24:42,  9.43s/it]  7%|▋         | 356/5475 [56:18<13:28:48,  9.48s/it]  7%|▋         | 357/5475 [56:27<13:32:05,  9.52s/it]  7%|▋         | 358/5475 [56:37<13:26:06,  9.45s/it]  7%|▋         | 359/5475 [56:46<13:29:44,  9.50s/it]  7%|▋         | 360/5475 [56:56<13:32:29,  9.53s/it]  7%|▋         | 361/5475 [57:05<13:34:26,  9.56s/it]  7%|▋         | 362/5475 [57:15<13:36:01,  9.58s/it]  7%|▋         | 363/5475 [57:24<13:27:35,  9.48s/it]  7%|▋         | 364/5475 [57:34<13:30:20,  9.51s/it]  7%|▋         | 365/5475 [57:43<13:32:48,  9.54s/it]  7%|▋         | 366/5475 [57:53<13:34:00,  9.56s/it]  7%|▋         | 367/5475 [58:03<13:35:00,  9.57s/it]  7%|▋         | 368/5475 [58:12<13:26:51,  9.48s/it]  7%|▋         | 369/5475 [58:22<13:29:40,  9.51s/it]  7%|▋         | 370/5475 [58:31<13:31:36,  9.54s/it]  7%|▋         | 371/5475 [58:41<13:32:52,  9.56s/it]  7%|▋         | 372/5475 [58:50<13:25:31,  9.47s/it]  7%|▋         | 373/5475 [59:00<13:28:27,  9.51s/it]  7%|▋         | 374/5475 [59:09<13:30:35,  9.53s/it]  7%|▋         | 375/5475 [59:19<13:32:11,  9.56s/it]  7%|▋         | 376/5475 [59:28<13:33:07,  9.57s/it]  7%|▋         | 377/5475 [59:38<13:33:43,  9.58s/it]  7%|▋         | 378/5475 [59:47<13:25:52,  9.49s/it]  7%|▋         | 379/5475 [59:57<13:20:05,  9.42s/it]  7%|▋         | 380/5475 [1:00:06<13:24:13,  9.47s/it]  7%|▋         | 381/5475 [1:00:16<13:27:25,  9.51s/it]  7%|▋         | 382/5475 [1:00:25<13:29:25,  9.54s/it]  7%|▋         | 383/5475 [1:00:35<13:31:42,  9.56s/it]  7%|▋         | 384/5475 [1:00:45<13:32:21,  9.57s/it]  7%|▋         | 385/5475 [1:00:54<13:25:34,  9.50s/it]  7%|▋         | 386/5475 [1:01:03<13:18:58,  9.42s/it]  7%|▋         | 387/5475 [1:01:12<13:15:07,  9.38s/it]  7%|▋         | 388/5475 [1:01:22<13:20:13,  9.44s/it]  7%|▋         | 389/5475 [1:01:32<13:24:33,  9.49s/it]  7%|▋         | 390/5475 [1:01:41<13:27:16,  9.53s/it]  7%|▋         | 391/5475 [1:01:50<13:12:18,  9.35s/it]  7%|▋         | 392/5475 [1:02:00<13:18:38,  9.43s/it]  7%|▋         | 393/5475 [1:02:09<13:15:17,  9.39s/it]  7%|▋         | 394/5475 [1:02:19<13:20:12,  9.45s/it]  7%|▋         | 395/5475 [1:02:28<13:15:42,  9.40s/it]  7%|▋         | 396/5475 [1:02:37<13:12:29,  9.36s/it]  7%|▋         | 397/5475 [1:02:47<13:18:17,  9.43s/it]  7%|▋         | 398/5475 [1:02:56<13:22:38,  9.49s/it]  7%|▋         | 399/5475 [1:03:06<13:25:15,  9.52s/it]  7%|▋         | 400/5475 [1:03:16<13:27:23,  9.55s/it]  7%|▋         | 401/5475 [1:03:25<13:29:25,  9.57s/it]  7%|▋         | 402/5475 [1:03:34<13:20:48,  9.47s/it]  7%|▋         | 403/5475 [1:03:44<13:24:05,  9.51s/it]  7%|▋         | 404/5475 [1:03:53<13:17:45,  9.44s/it]  7%|▋         | 405/5475 [1:04:03<13:21:35,  9.49s/it]  7%|▋         | 406/5475 [1:04:13<13:24:30,  9.52s/it]  7%|▋         | 407/5475 [1:04:22<13:26:18,  9.55s/it]  7%|▋         | 408/5475 [1:04:32<13:27:37,  9.56s/it]  7%|▋         | 409/5475 [1:04:41<13:19:44,  9.47s/it]  7%|▋         | 410/5475 [1:04:51<13:22:59,  9.51s/it]  8%|▊         | 411/5475 [1:05:00<13:25:07,  9.54s/it]  8%|▊         | 412/5475 [1:05:10<13:26:28,  9.56s/it]  8%|▊         | 413/5475 [1:05:19<13:27:04,  9.57s/it]  8%|▊         | 414/5475 [1:05:29<13:28:13,  9.58s/it]  8%|▊         | 415/5475 [1:05:39<13:28:26,  9.59s/it]  8%|▊         | 416/5475 [1:05:48<13:28:45,  9.59s/it]  8%|▊         | 417/5475 [1:05:58<13:28:44,  9.59s/it]  8%|▊         | 418/5475 [1:06:07<13:28:42,  9.60s/it]  8%|▊         | 419/5475 [1:06:17<13:28:30,  9.59s/it]  8%|▊         | 420/5475 [1:06:27<13:28:26,  9.60s/it]  8%|▊         | 421/5475 [1:06:36<13:28:59,  9.60s/it]  8%|▊         | 422/5475 [1:06:46<13:28:35,  9.60s/it]  8%|▊         | 423/5475 [1:06:55<13:28:27,  9.60s/it]  8%|▊         | 424/5475 [1:07:05<13:27:42,  9.59s/it]  8%|▊         | 425/5475 [1:07:15<13:27:54,  9.60s/it]  8%|▊         | 426/5475 [1:07:24<13:27:42,  9.60s/it]  8%|▊         | 427/5475 [1:07:34<13:27:11,  9.59s/it]  8%|▊         | 428/5475 [1:07:43<13:27:01,  9.59s/it]  8%|▊         | 429/5475 [1:07:53<13:26:55,  9.59s/it]  8%|▊         | 430/5475 [1:08:02<13:19:20,  9.51s/it]  8%|▊         | 431/5475 [1:08:12<13:13:27,  9.44s/it]  8%|▊         | 432/5475 [1:08:21<13:17:29,  9.49s/it]  8%|▊         | 433/5475 [1:08:31<13:19:47,  9.52s/it]  8%|▊         | 434/5475 [1:08:40<13:21:39,  9.54s/it]  8%|▊         | 435/5475 [1:08:50<13:14:22,  9.46s/it]  8%|▊         | 436/5475 [1:08:59<13:18:02,  9.50s/it]  8%|▊         | 437/5475 [1:09:09<13:20:40,  9.54s/it]  8%|▊         | 438/5475 [1:09:18<13:21:37,  9.55s/it]  8%|▊         | 439/5475 [1:09:28<13:14:36,  9.47s/it]  8%|▊         | 440/5475 [1:09:37<13:18:03,  9.51s/it]  8%|▊         | 441/5475 [1:09:47<13:20:26,  9.54s/it]  8%|▊         | 442/5475 [1:09:57<13:21:57,  9.56s/it]  8%|▊         | 443/5475 [1:10:06<13:14:18,  9.47s/it]  8%|▊         | 444/5475 [1:10:15<13:17:21,  9.51s/it]  8%|▊         | 445/5475 [1:10:25<13:11:14,  9.44s/it]  8%|▊         | 446/5475 [1:10:34<13:06:18,  9.38s/it]  8%|▊         | 447/5475 [1:10:43<13:10:50,  9.44s/it]  8%|▊         | 448/5475 [1:10:53<13:14:18,  9.48s/it]  8%|▊         | 449/5475 [1:11:03<13:17:06,  9.52s/it]  8%|▊         | 450/5475 [1:11:12<13:19:06,  9.54s/it]  8%|▊         | 451/5475 [1:11:21<13:04:00,  9.36s/it]  8%|▊         | 452/5475 [1:11:31<13:09:59,  9.44s/it]  8%|▊         | 453/5475 [1:11:40<13:14:04,  9.49s/it]  8%|▊         | 454/5475 [1:11:50<13:08:38,  9.42s/it]  8%|▊         | 455/5475 [1:11:59<13:12:46,  9.48s/it]  8%|▊         | 456/5475 [1:12:09<13:16:16,  9.52s/it]  8%|▊         | 457/5475 [1:12:18<13:10:06,  9.45s/it]  8%|▊         | 458/5475 [1:12:28<13:14:28,  9.50s/it]  8%|▊         | 459/5475 [1:12:37<13:16:46,  9.53s/it]  8%|▊         | 460/5475 [1:12:47<13:18:34,  9.55s/it]  8%|▊         | 461/5475 [1:12:56<13:11:26,  9.47s/it]  8%|▊         | 462/5475 [1:13:06<13:14:27,  9.51s/it]  8%|▊         | 463/5475 [1:13:15<13:16:27,  9.53s/it]  8%|▊         | 464/5475 [1:13:25<13:18:05,  9.56s/it]  8%|▊         | 465/5475 [1:13:35<13:19:19,  9.57s/it]  9%|▊         | 466/5475 [1:13:44<13:03:44,  9.39s/it]  9%|▊         | 467/5475 [1:13:53<13:09:03,  9.45s/it]  9%|▊         | 468/5475 [1:14:03<13:12:34,  9.50s/it]  9%|▊         | 469/5475 [1:14:12<13:15:34,  9.54s/it]  9%|▊         | 470/5475 [1:14:22<13:17:08,  9.56s/it]  9%|▊         | 471/5475 [1:14:32<13:18:33,  9.57s/it]  9%|▊         | 472/5475 [1:14:41<13:11:29,  9.49s/it]  9%|▊         | 473/5475 [1:14:51<13:14:13,  9.53s/it]  9%|▊         | 474/5475 [1:15:00<13:16:02,  9.55s/it]  9%|▊         | 475/5475 [1:15:10<13:17:29,  9.57s/it]  9%|▊         | 476/5475 [1:15:19<13:18:07,  9.58s/it]  9%|▊         | 477/5475 [1:15:29<13:18:33,  9.59s/it]  9%|▊         | 478/5475 [1:15:38<13:10:32,  9.49s/it]  9%|▊         | 479/5475 [1:15:48<13:13:16,  9.53s/it]  9%|▉         | 480/5475 [1:15:57<13:06:55,  9.45s/it]  9%|▉         | 481/5475 [1:16:06<13:02:41,  9.40s/it]  9%|▉         | 482/5475 [1:16:16<12:59:22,  9.37s/it]  9%|▉         | 483/5475 [1:16:25<13:05:16,  9.44s/it]  9%|▉         | 484/5475 [1:16:35<13:09:20,  9.49s/it]  9%|▉         | 485/5475 [1:16:45<13:12:03,  9.52s/it]  9%|▉         | 486/5475 [1:16:54<13:14:17,  9.55s/it]  9%|▉         | 487/5475 [1:17:04<13:15:27,  9.57s/it]  9%|▉         | 488/5475 [1:17:13<13:16:15,  9.58s/it]  9%|▉         | 489/5475 [1:17:23<13:17:14,  9.59s/it]  9%|▉         | 490/5475 [1:17:33<13:17:39,  9.60s/it]  9%|▉         | 491/5475 [1:17:42<13:17:55,  9.61s/it]  9%|▉         | 492/5475 [1:17:52<13:17:56,  9.61s/it]  9%|▉         | 493/5475 [1:18:01<13:10:04,  9.52s/it]  9%|▉         | 494/5475 [1:18:11<13:04:51,  9.45s/it]  9%|▉         | 495/5475 [1:18:20<13:08:14,  9.50s/it]  9%|▉         | 496/5475 [1:18:30<13:10:43,  9.53s/it]  9%|▉         | 497/5475 [1:18:39<13:12:29,  9.55s/it]  9%|▉         | 498/5475 [1:18:49<13:06:08,  9.48s/it]  9%|▉         | 499/5475 [1:18:58<13:00:11,  9.41s/it]  9%|▉         | 500/5475 [1:19:07<13:04:34,  9.46s/it]                                                         9%|▉         | 500/5475 [1:19:07<13:04:34,  9.46s/it]{'loss': 10.7039, 'grad_norm': 2.0710182189941406, 'learning_rate': 0.00018526511627906978, 'epoch': 0.27}
Traceback (most recent call last):
  File "/root/resume_summary/sftp.py", line 326, in <module>
    train()
  File "/root/resume_summary/sftp.py", line 254, in train
    trainer.train()
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 2612, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 3085, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 3039, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 4105, in evaluate
    output = eval_loop(
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 4299, in evaluation_loop
    losses, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/trainer.py", line 4515, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
  File "/root/resume_summary/sftp.py", line 141, in compute_loss
    outputs = model(**inputs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/accelerate/utils/operations.py", line 818, in forward
    return model_forward(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/accelerate/utils/operations.py", line 806, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/peft/peft_model.py", line 1845, in forward
    return self.base_model(
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 216, in forward
    return self.model.forward(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/models/qwen2/modeling_qwen2.py", line 877, in forward
    loss = self.loss_function(logits=logits, labels=labels, vocab_size=self.config.vocab_size, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/loss/loss_utils.py", line 47, in ForCausalLMLoss
    loss = fixed_cross_entropy(logits, shift_labels, num_items_in_batch, ignore_index, **kwargs)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/transformers/loss/loss_utils.py", line 26, in fixed_cross_entropy
    loss = nn.functional.cross_entropy(source, target, ignore_index=ignore_index, reduction=reduction)
  File "/root/miniconda3/envs/spacy_linux/lib/python3.10/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 11.32 GiB. GPU 0 has a total capacity of 23.68 GiB of which 1.55 GiB is free. Including non-PyTorch memory, this process has 22.12 GiB memory in use. Of the allocated memory 21.02 GiB is allocated by PyTorch, and 835.57 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
  9%|▉         | 500/5475 [1:19:10<13:07:46,  9.50s/it]
